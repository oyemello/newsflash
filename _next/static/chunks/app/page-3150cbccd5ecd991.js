(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5697:function(e,t,n){Promise.resolve().then(n.bind(n,7340))},7340:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var s,r=n(7437);n(4798);var l=n(2265),a=n(257);let o=["All","World","Business","Technology","Markets","Sports","Entertainment"],i=null!==(s=a.env.NEXT_PUBLIC_FEED_URL)&&void 0!==s?s:window.location.pathname.startsWith("/newsflash")?"/newsflash/data/feed.json":"/data/feed.json",c=a.env.NEXT_PUBLIC_FEED_FALLBACK||"https://raw.githubusercontent.com/oyemello/newsflash/gh-pages/data/feed.json";async function d(e,t){let n=e=>e+(e.includes("?")?"&":"?")+"v="+Date.now();try{let t=await fetch(n(e),{cache:"no-store"});if(t.ok)return await t.json();console.warn("Primary feed failed",t.status)}catch(e){console.warn("Primary feed error:",(null==e?void 0:e.message)||e)}let s=await fetch(n(t),{cache:"no-store"});if(!s.ok)throw Error("Both feed URLs failed: "+s.status);return await s.json()}function u(){var e,t,n,s;let{label:a,lastUpdatedError:u,version:h}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,[t,n]=(0,l.useState)(null),[s,r]=(0,l.useState)(null),[a,o]=(0,l.useState)(null);async function c(e){try{let t=await fetch(i,{cache:"no-store",signal:e});if(!t.ok)throw Error("HTTP ".concat(t.status));let s=await t.json();(null==s?void 0:s.generatedAt)&&n(s.generatedAt),(null==s?void 0:s.version)&&r(String(s.version)),o(null)}catch(e){o((null==e?void 0:e.message)||"fetch failed")}}return(0,l.useEffect)(()=>{let t=new AbortController;c(t.signal);let n=setInterval(()=>c(),e);return()=>{t.abort(),clearInterval(n)}},[e]),{label:(0,l.useMemo)(()=>{if(!t)return"—";try{return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return t}},[t]),lastUpdatedError:a,version:s}}(6e4),[m,f]=(0,l.useState)([]),[g,p]=(0,l.useState)(!0),[v,x]=(0,l.useState)(""),[y,b]=(0,l.useState)([]),[w,j]=(0,l.useState)(null),[N,k]=(0,l.useState)(o[0]),[S,L]=(0,l.useState)(!1),[E,T]=(0,l.useState)(null!==(e=localStorage.getItem("newsflash.theme"))&&void 0!==e?e:"light");(0,l.useEffect)(()=>{localStorage.setItem("newsflash.theme",E),document.body.classList.toggle("bg-dark","dark"===E),document.body.classList.toggle("bg-light","light"===E),document.body.classList.toggle("text-light","dark"===E),document.body.classList.toggle("text-dark","light"===E)},[E]);let C={news:null!==(t=null==m?void 0:m.length)&&void 0!==t?t:0,filtered:null!==(n=null==y?void 0:y.length)&&void 0!==n?n:0},_=(0,l.useMemo)(()=>{let e=new Set;return m.forEach(t=>{t.source_name?e.add(t.source_name):t.source_id&&e.add(t.source_id)}),Array.from(e).sort()},[m]),{sources:I,topics:A,setSources:P,setTopics:B}=function(e,t){let[n,s]=(0,l.useState)([]),[r,a]=(0,l.useState)([]);return(0,l.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("sources"),n=e.get("topics");if(t)s(t.split(",").filter(Boolean));else{let e=localStorage.getItem("newsflash.sources");e&&s(JSON.parse(e))}if(n)a(n.split(",").filter(Boolean));else{let e=localStorage.getItem("newsflash.topics");e&&a(JSON.parse(e))}},[e.length,t.length]),(0,l.useEffect)(()=>{localStorage.setItem("newsflash.sources",JSON.stringify(n))},[n]),(0,l.useEffect)(()=>{localStorage.setItem("newsflash.topics",JSON.stringify(r))},[r]),{sources:n,topics:r,setSources:s,setTopics:a,applyFromUrl:function(){let e=new URLSearchParams(window.location.search),t=e.get("sources"),n=e.get("topics");t&&s(t.split(",").filter(Boolean)),n&&a(n.split(",").filter(Boolean))},toQueryString:function(){let e=new URLSearchParams;return n.length&&e.set("sources",n.join(",")),r.length&&e.set("topics",r.join(",")),e.toString()}}}(_,(0,l.useMemo)(()=>{let e=new Set;return m.forEach(t=>{t.topics&&t.topics.length&&t.topics.forEach(t=>e.add(t))}),0===e.size&&["world","business","technology","markets","sports","entertainment"].forEach(t=>e.add(t)),Array.from(e).sort()},[m])),[D,O]=(0,l.useState)(()=>{{let e=localStorage.getItem("sourcePrefs");if(e)return JSON.parse(e)}return[]}),[U,M]=(0,l.useState)(!1);(0,l.useEffect)(()=>{localStorage.setItem("sourcePrefs",JSON.stringify(D))},[D]);let[J,W]=(0,l.useState)("latest");(0,l.useEffect)(()=>{let e=m;I.length&&(e=e.filter(e=>I.includes(e.source_name||e.source_id))),A.length&&(e=e.filter(e=>e.topics&&e.topics.some(e=>A.includes(e)))),""!==v.trim()&&(e=e.filter(e=>{var t,n,s;return e.title.toLowerCase().includes(v.toLowerCase())||(null!==(t=e.summary_90w)&&void 0!==t?t:"").toLowerCase().includes(v.toLowerCase())||(null!==(s=null!==(n=e.source_name)&&void 0!==n?n:e.source_id)&&void 0!==s?s:"").toLowerCase().includes(v.toLowerCase())})),b(e=e.slice().sort((e,t)=>{var n,s;let r=new Date(null!==(n=e.published)&&void 0!==n?n:0).getTime(),l=new Date(null!==(s=t.published)&&void 0!==s?s:0).getTime();return"latest"===J?l-r:r-l}))},[m,I,A,v,J]);let F=(0,l.useMemo)(()=>"All"===N?y:y.filter(e=>(function(e){if(e.topics&&e.topics.length)return e.topics[0]||"World";let t=(e.source_id||"").toLowerCase(),n=(e.title||"").toLowerCase();return t.includes("world")?"World":t.includes("business")||n.includes("market")?"Business":t.includes("tech")||t.includes("technology")||n.includes("ai")?"Technology":t.includes("market")?"Markets":t.includes("sport")?"Sports":t.includes("entertain")?"Entertainment":"World"})(e).toLowerCase()===N.toLowerCase()),[y,N]);(0,l.useEffect)(()=>{(async()=>{try{var e;p(!0);let t=await d(i,c),n=Array.isArray(t)?t:null!==(e=t.items)&&void 0!==e?e:[];console.log("feed items len =",n.length),f(n),b(n),j(null)}catch(e){f([]),b([]),j((null==e?void 0:e.message)||"Failed to fetch news")}finally{p(!1)}})();let e=setInterval(async()=>{try{var e;let t=await d(i,c),n=Array.isArray(t)?t:null!==(e=t.items)&&void 0!==e?e:[];t.version&&t.version!==h&&(f(n),b(n),j(null))}catch(e){}},6e4);return()=>clearInterval(e)},[h]);let[R,z]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{let e=setInterval(async()=>{try{let e=await fetch("/data/feed.json"),t=await e.json();t.version&&t.version!==h&&z(!0)}catch(e){}},6e4);return()=>clearInterval(e)},[h]),g)return(0,r.jsx)("main",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-gray-600 text-base",children:"Loading latest feed…"})});if(w)return(0,r.jsx)("main",{className:"flex items-center justify-center h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Error loading news"}),(0,r.jsx)("p",{className:"text-gray-700",children:w})]})});let X=(null!==(s=null==m?void 0:m.length)&&void 0!==s?s:0)>0;return(0,r.jsxs)("main",{className:"container py-5 ".concat("dark"===E?"bg-dark text-light":"bg-light text-dark"),children:[(0,r.jsxs)("div",{className:"position-fixed top-0 end-0 m-3 p-2 rounded shadow ".concat("dark"===E?"bg-dark text-white":"bg-light text-dark"),style:{zIndex:50,fontSize:12},children:[(0,r.jsxs)("div",{children:["items: ",C.news]}),(0,r.jsxs)("div",{children:["shown: ",C.filtered]})]}),(0,r.jsx)("header",{className:"d-flex flex-column align-items-center justify-content-center mb-3",style:{borderBottom:"1px solid #eee"},children:(0,r.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{background:"dark"===E?"transparent":"rgba(255,255,255,.9)",width:"100%",justifyContent:"center",padding:"12px 0"},children:[(0,r.jsx)("span",{className:"fw-semibold",children:"Sort by:"}),(0,r.jsx)("button",{className:"btn btn-sm ".concat("latest"===J?"btn-primary":"btn-outline-primary"),onClick:()=>W("latest"),children:"Latest"}),(0,r.jsx)("button",{className:"btn btn-sm ".concat("oldest"===J?"btn-primary":"btn-outline-primary"),onClick:()=>W("oldest"),children:"Oldest"}),(0,r.jsxs)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>M(!0),children:["Sources",D.length>0?" (".concat(D.length,")"):""]}),(0,r.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:function(){T(e=>"light"===e?"dark":"light")},children:"dark"===E?"Light Mode":"Dark Mode"})]})}),(0,r.jsx)("div",{className:"d-flex justify-content-center mb-3",children:(0,r.jsx)("ul",{className:"nav nav-tabs mb-4",children:o.map(e=>(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("button",{className:"nav-link".concat(N===e?" active":""),"aria-current":N===e?"page":void 0,style:N===e?{pointerEvents:"none"}:{},onClick:()=>N!==e&&void k(e),disabled:N===e,children:e})},e))})}),X&&0===F.length&&(0,r.jsx)("div",{className:"alert alert-warning small mb-2",role:"alert",children:"No items in this topic yet."}),(0,r.jsxs)("div",{className:"row g-4",children:[X&&0===F.length&&(0,r.jsxs)("div",{className:"col-12 text-center py-5",children:[(0,r.jsx)("h2",{className:"h4 fw-bold mb-2",children:"No news found"}),(0,r.jsx)("p",{className:"text-muted",children:"Try adjusting your preferences or check back later."})]}),!X&&(0,r.jsx)("div",{className:"col-12 text-center py-5",children:(0,r.jsx)("span",{className:"text-muted",children:"Loading latest feed…"})}),F.length>0&&F.map((e,t)=>{var n,s,l,a;return(0,r.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,r.jsx)("div",{className:"card h-100 shadow-sm ".concat("dark"===E?"bg-secondary text-light":""),children:(0,r.jsxs)("div",{className:"card-body d-flex flex-column",children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,r.jsx)("span",{className:"text-secondary small",children:function(e){if(!e)return"Unknown date";let t=new Date(e),n=Math.floor((new Date().getTime()-t.getTime())/36e5);return n<1?"Just now":1===n?"1 hour ago":n<24?"".concat(n," hours ago"):new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)}(e.published)}),(0,r.jsx)("span",{className:"text-secondary small",children:null!==(s=null!==(n=e.source_name)&&void 0!==n?n:e.source_id)&&void 0!==s?s:""})]}),(0,r.jsx)("h5",{className:"card-title mb-2",children:(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"stretched-link text-decoration-none ".concat("dark"===E?"text-light":"text-dark"),children:e.title})}),(0,r.jsx)("p",{className:"card-text text-muted small flex-grow-1",children:null!==(l=e.summary_90w)&&void 0!==l?l:""})]})})},null!==(a=e.id)&&void 0!==a?a:e.url)})]}),U&&(0,r.jsx)("div",{className:"fixed inset-0 bg-opacity-30 z-50",onClick:()=>M(!1),children:(0,r.jsx)("div",{className:"modal-dialog modal-dialog-centered",onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"modal-content p-3 ".concat("dark"===E?"bg-modal-dark":"bg-modal-light"," modal-lg\" style={{minWidth: '340px', maxWidth: '480px'}}"),children:[(0,r.jsx)("div",{className:"mb-3",children:_.map(e=>(0,r.jsxs)("label",{className:"d-block mb-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:D.includes(e),onChange:t=>{O(n=>t.target.checked?[...n,e]:n.filter(t=>t!==e))}})," ",e]},e))}),(0,r.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>M(!1),children:"Done"})]})})}),R&&(0,r.jsxs)("div",{className:"alert alert-info text-center",style:{position:"fixed",top:0,left:0,right:0,zIndex:100},children:["New news available! ",(0,r.jsx)("button",{className:"btn btn-sm btn-primary ms-2",onClick:()=>window.location.reload(),children:"Refresh"})]})]})}},257:function(e,t,n){"use strict";var s,r;e.exports=(null==(s=n.g.process)?void 0:s.env)&&"object"==typeof(null==(r=n.g.process)?void 0:r.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,s,r=e.exports={};function l(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var i=[],c=!1,d=-1;function u(){c&&s&&(c=!1,s.length?i=s.concat(i):d=-1,i.length&&h())}function h(){if(!c){var e=o(u);c=!0;for(var t=i.length;t;){for(s=i,i=[];++d<t;)s&&s[d].run();d=-1,t=i.length}s=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.push(new m(e,t)),1!==i.length||c||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var l=n[e]={exports:{}},a=!0;try{t[e](l,l.exports,s),a=!1}finally{a&&delete n[e]}return l.exports}s.ab="//";var r=s(229);e.exports=r}()},4798:function(){}},function(e){e.O(0,[669,971,117,744],function(){return e(e.s=5697)}),_N_E=e.O()}]);