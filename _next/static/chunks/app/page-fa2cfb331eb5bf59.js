(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5697:function(e,t,s){Promise.resolve().then(s.bind(s,7340))},7340:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var n=s(7437);s(4798);var l=s(2265);let a=["All","World","Business","Technology","Markets","Sports","Entertainment"],r="/data/feed.json";function i(){var e,t,s,i;let{label:o,lastUpdatedError:c,version:d}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,[t,s]=(0,l.useState)(null),[n,a]=(0,l.useState)(null),[i,o]=(0,l.useState)(null);async function c(e){try{let t=await fetch(r,{cache:"no-store",signal:e});if(!t.ok)throw Error("HTTP ".concat(t.status));let n=await t.json();(null==n?void 0:n.generatedAt)&&s(n.generatedAt),(null==n?void 0:n.version)&&a(String(n.version)),o(null)}catch(e){o((null==e?void 0:e.message)||"fetch failed")}}return(0,l.useEffect)(()=>{let t=new AbortController;c(t.signal);let s=setInterval(()=>c(),e);return()=>{t.abort(),clearInterval(s)}},[e]),{label:(0,l.useMemo)(()=>{if(!t)return"—";try{return new Date(t).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(e){return t}},[t]),lastUpdatedError:i,version:n}}(6e4),[u,m]=(0,l.useState)([]),[h,f]=(0,l.useState)(!0),[g,x]=(0,l.useState)(""),[b,p]=(0,l.useState)([]),[v,w]=(0,l.useState)(null),[y,j]=(0,l.useState)(a[0]),[N,k]=(0,l.useState)(!1),[S,C]=(0,l.useState)(null!==(e=localStorage.getItem("newsflash.theme"))&&void 0!==e?e:"light");(0,l.useEffect)(()=>{localStorage.setItem("newsflash.theme",S),document.body.classList.toggle("bg-dark","dark"===S),document.body.classList.toggle("bg-light","light"===S),document.body.classList.toggle("text-light","dark"===S),document.body.classList.toggle("text-dark","light"===S)},[S]);let E={news:null!==(t=null==u?void 0:u.length)&&void 0!==t?t:0,filtered:null!==(s=null==b?void 0:b.length)&&void 0!==s?s:0},L=(0,l.useMemo)(()=>{let e=new Set;return u.forEach(t=>{t.source_name?e.add(t.source_name):t.source_id&&e.add(t.source_id)}),Array.from(e).sort()},[u]),{sources:_,topics:I,setSources:A,setTopics:T}=function(e,t){let[s,n]=(0,l.useState)([]),[a,r]=(0,l.useState)([]);return(0,l.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("sources"),s=e.get("topics");if(t)n(t.split(",").filter(Boolean));else{let e=localStorage.getItem("newsflash.sources");e&&n(JSON.parse(e))}if(s)r(s.split(",").filter(Boolean));else{let e=localStorage.getItem("newsflash.topics");e&&r(JSON.parse(e))}},[e.length,t.length]),(0,l.useEffect)(()=>{localStorage.setItem("newsflash.sources",JSON.stringify(s))},[s]),(0,l.useEffect)(()=>{localStorage.setItem("newsflash.topics",JSON.stringify(a))},[a]),{sources:s,topics:a,setSources:n,setTopics:r,applyFromUrl:function(){let e=new URLSearchParams(window.location.search),t=e.get("sources"),s=e.get("topics");t&&n(t.split(",").filter(Boolean)),s&&r(s.split(",").filter(Boolean))},toQueryString:function(){let e=new URLSearchParams;return s.length&&e.set("sources",s.join(",")),a.length&&e.set("topics",a.join(",")),e.toString()}}}(L,(0,l.useMemo)(()=>{let e=new Set;return u.forEach(t=>{t.topics&&t.topics.length&&t.topics.forEach(t=>e.add(t))}),0===e.size&&["world","business","technology","markets","sports","entertainment"].forEach(t=>e.add(t)),Array.from(e).sort()},[u])),[M,O]=(0,l.useState)(()=>{{let e=localStorage.getItem("sourcePrefs");if(e)return JSON.parse(e)}return[]}),[D,P]=(0,l.useState)(!1);(0,l.useEffect)(()=>{localStorage.setItem("sourcePrefs",JSON.stringify(M))},[M]);let[B,J]=(0,l.useState)("latest");(0,l.useEffect)(()=>{let e=u;_.length&&(e=e.filter(e=>_.includes(e.source_name||e.source_id))),I.length&&(e=e.filter(e=>e.topics&&e.topics.some(e=>I.includes(e)))),""!==g.trim()&&(e=e.filter(e=>{var t,s,n;return e.title.toLowerCase().includes(g.toLowerCase())||(null!==(t=e.summary_90w)&&void 0!==t?t:"").toLowerCase().includes(g.toLowerCase())||(null!==(n=null!==(s=e.source_name)&&void 0!==s?s:e.source_id)&&void 0!==n?n:"").toLowerCase().includes(g.toLowerCase())})),p(e=e.slice().sort((e,t)=>{var s,n;let l=new Date(null!==(s=e.published)&&void 0!==s?s:0).getTime(),a=new Date(null!==(n=t.published)&&void 0!==n?n:0).getTime();return"latest"===B?a-l:l-a}))},[u,_,I,g,B]);let U=(0,l.useMemo)(()=>"All"===y?b:b.filter(e=>(function(e){if(e.topics&&e.topics.length)return e.topics[0]||"World";let t=(e.source_id||"").toLowerCase(),s=(e.title||"").toLowerCase();return t.includes("world")?"World":t.includes("business")||s.includes("market")?"Business":t.includes("tech")||t.includes("technology")||s.includes("ai")?"Technology":t.includes("market")?"Markets":t.includes("sport")?"Sports":t.includes("entertain")?"Entertainment":"World"})(e).toLowerCase()===y.toLowerCase()),[b,y]);(0,l.useEffect)(()=>{(async()=>{try{var e;f(!0);let t=await fetch(r);if(console.log("fetchNews response.status:",t.status),!t.ok)throw Error("Feed not found");let s=await t.json(),n=Array.isArray(s)?s:null!==(e=s.items)&&void 0!==e?e:[];console.log("feed items len =",n.length),m(n),p(n),w(null)}catch(e){m([]),p([]),w((null==e?void 0:e.message)||"Failed to fetch news")}finally{f(!1)}})();let e=setInterval(async()=>{try{var e;let t=await fetch(r);if(!t.ok)return;let s=await t.json(),n=Array.isArray(s)?s:null!==(e=s.items)&&void 0!==e?e:[];console.log("feed items len =",n.length),s.version&&s.version!==d&&(m(n),p(n),w(null))}catch(e){}},6e4);return()=>clearInterval(e)},[d]);let[W,z]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{let e=setInterval(async()=>{try{let e=await fetch("/data/feed.json"),t=await e.json();t.version&&t.version!==d&&z(!0)}catch(e){}},6e4);return()=>clearInterval(e)},[d]),h)return(0,n.jsx)("main",{className:"flex items-center justify-center h-screen",children:(0,n.jsx)("div",{className:"text-gray-600 text-base",children:"Loading latest feed…"})});if(v)return(0,n.jsx)("main",{className:"flex items-center justify-center h-screen",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Error loading news"}),(0,n.jsx)("p",{className:"text-gray-700",children:v})]})});let F=(null!==(i=null==u?void 0:u.length)&&void 0!==i?i:0)>0;return(0,n.jsxs)("main",{className:"container py-5 ".concat("dark"===S?"bg-dark text-light":"bg-light text-dark"),children:[(0,n.jsxs)("div",{className:"position-fixed top-0 end-0 m-3 p-2 rounded shadow ".concat("dark"===S?"bg-dark text-white":"bg-light text-dark"),style:{zIndex:50,fontSize:12},children:[(0,n.jsxs)("div",{children:["items: ",E.news]}),(0,n.jsxs)("div",{children:["shown: ",E.filtered]})]}),(0,n.jsx)("header",{className:"d-flex flex-column align-items-center justify-content-center mb-3",style:{borderBottom:"1px solid #eee"},children:(0,n.jsxs)("div",{className:"d-flex align-items-center gap-2",style:{background:"dark"===S?"transparent":"rgba(255,255,255,.9)",width:"100%",justifyContent:"center",padding:"12px 0"},children:[(0,n.jsx)("span",{className:"fw-semibold",children:"Sort by:"}),(0,n.jsx)("button",{className:"btn btn-sm ".concat("latest"===B?"btn-primary":"btn-outline-primary"),onClick:()=>J("latest"),children:"Latest"}),(0,n.jsx)("button",{className:"btn btn-sm ".concat("oldest"===B?"btn-primary":"btn-outline-primary"),onClick:()=>J("oldest"),children:"Oldest"}),(0,n.jsxs)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>P(!0),children:["Sources",M.length>0?" (".concat(M.length,")"):""]}),(0,n.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:function(){C(e=>"light"===e?"dark":"light")},children:"dark"===S?"Light Mode":"Dark Mode"})]})}),(0,n.jsx)("div",{className:"d-flex justify-content-center mb-3",children:(0,n.jsx)("ul",{className:"nav nav-tabs mb-4",children:a.map(e=>(0,n.jsx)("li",{className:"nav-item",children:(0,n.jsx)("button",{className:"nav-link".concat(y===e?" active":""),"aria-current":y===e?"page":void 0,style:y===e?{pointerEvents:"none"}:{},onClick:()=>y!==e&&void j(e),disabled:y===e,children:e})},e))})}),F&&0===U.length&&(0,n.jsx)("div",{className:"alert alert-warning small mb-2",role:"alert",children:"No items in this topic yet."}),(0,n.jsxs)("div",{className:"row g-4",children:[F&&0===U.length&&(0,n.jsxs)("div",{className:"col-12 text-center py-5",children:[(0,n.jsx)("h2",{className:"h4 fw-bold mb-2",children:"No news found"}),(0,n.jsx)("p",{className:"text-muted",children:"Try adjusting your preferences or check back later."})]}),!F&&(0,n.jsx)("div",{className:"col-12 text-center py-5",children:(0,n.jsx)("span",{className:"text-muted",children:"Loading latest feed…"})}),U.length>0&&U.map((e,t)=>{var s,l,a,r;return(0,n.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,n.jsx)("div",{className:"card h-100 shadow-sm ".concat("dark"===S?"bg-secondary text-light":""),children:(0,n.jsxs)("div",{className:"card-body d-flex flex-column",children:[(0,n.jsxs)("div",{className:"d-flex justify-content-between mb-2",children:[(0,n.jsx)("span",{className:"text-secondary small",children:function(e){if(!e)return"Unknown date";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/36e5);return s<1?"Just now":1===s?"1 hour ago":s<24?"".concat(s," hours ago"):new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)}(e.published)}),(0,n.jsx)("span",{className:"text-secondary small",children:null!==(l=null!==(s=e.source_name)&&void 0!==s?s:e.source_id)&&void 0!==l?l:""})]}),(0,n.jsx)("h5",{className:"card-title mb-2",children:(0,n.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"stretched-link text-decoration-none ".concat("dark"===S?"text-light":"text-dark"),children:e.title})}),(0,n.jsx)("p",{className:"card-text text-muted small flex-grow-1",children:null!==(a=e.summary_90w)&&void 0!==a?a:""})]})})},null!==(r=e.id)&&void 0!==r?r:e.url)})]}),D&&(0,n.jsx)("div",{className:"fixed inset-0 bg-opacity-30 z-50",onClick:()=>P(!1),children:(0,n.jsx)("div",{className:"modal-dialog modal-dialog-centered",onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"modal-content p-3 ".concat("dark"===S?"bg-modal-dark":"bg-modal-light"," modal-lg\" style={{minWidth: '340px', maxWidth: '480px'}}"),children:[(0,n.jsx)("div",{className:"mb-3",children:L.map(e=>(0,n.jsxs)("label",{className:"d-block mb-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:M.includes(e),onChange:t=>{O(s=>t.target.checked?[...s,e]:s.filter(t=>t!==e))}})," ",e]},e))}),(0,n.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>P(!1),children:"Done"})]})})}),W&&(0,n.jsxs)("div",{className:"alert alert-info text-center",style:{position:"fixed",top:0,left:0,right:0,zIndex:100},children:["New news available! ",(0,n.jsx)("button",{className:"btn btn-sm btn-primary ms-2",onClick:()=>window.location.reload(),children:"Refresh"})]})]})}},4798:function(){}},function(e){e.O(0,[669,971,117,744],function(){return e(e.s=5697)}),_N_E=e.O()}]);